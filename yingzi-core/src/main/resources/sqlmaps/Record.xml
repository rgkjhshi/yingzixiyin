<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mapper.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper  namespace="com.yingzixiyin.core.dao.RecordDao">

    <sql id="base_select">
        SELECT
            id                  AS id,
            user_id             AS userId,
            consultant_id       AS consultantId,
            consult_type        AS consultType,
            is_paid             AS isPaid,
            is_replied          AS isReplied,
            is_completed        AS isCompleted,
            create_time         AS createTime
        FROM record
    </sql>

    <!-- 查询条件 -->
    <sql id="where_condition">
        <where>
            <if test="id != null">
                id = #{id}
            </if>
            <if test="userId != null">
                AND user_id = #{userId}
            </if>
            <if test="consultantId != null">
                AND consultant_id = #{consultantId}
            </if>
            <if test="consultType != null">
                AND consult_type = #{consultType}
            </if>
            <if test="isPaid != null">
                AND is_paid = #{isPaid}
            </if>
            <if test="isReplied != null">
                AND is_replied = #{isReplied}
            </if>
            <if test="isCompleted != null">
                AND is_completed = #{isCompleted}
            </if>
        </where>
    </sql>

    <insert id="insert" parameterType="Record" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO record
        (
        <if test="userId != null">
            user_id
        </if>
        <if test="consultantId != null">
            ,consultant_id
        </if>
        <if test="consultType != null">
            ,consult_type
        </if>
        <if test="isPaid != null">
            ,is_paid
        </if>
        <if test="isReplied != null">
            ,is_replied
        </if>
        <if test="isCompleted != null">
            ,is_completed
        </if>
        <if test="createTime != null">
            ,create_time
        </if>
        )
        values
        (
        <if test="userId != null">
            #{userId}
        </if>
        <if test="consultantId != null">
            ,#{consultantId}
        </if>
        <if test="consultType != null">
            ,#{consultType}
        </if>
        <if test="isPaid != null">
            ,#{isPaid}
        </if>
        <if test="isReplied != null">
            ,#{isReplied}
        </if>
        <if test="isCompleted != null">
            ,#{isCompleted}
        </if>
        <if test="createTime != null">
            ,#{createTime}
        </if>
        )
    </insert>

    <update id="update" parameterType="Record">
        UPDATE   record
        <set>
            <if test="userId != null">
                user_id = #{userId},
            </if>
            <if test="consultantId != null">
                consultant_id = #{consultantId},
            </if>
            <if test="consultType != null">
                consult_type = #{consultType},
            </if>
            <if test="isPaid != null">
                is_paid = #{isPaid},
            </if>
            <if test="isReplied != null">
                is_replied = #{isReplied},
            </if>
            <if test="isCompleted != null">
                is_completed = #{isCompleted},
            </if>
            <if test="createTime != null">
                create_time = #{createTime},
            </if>
        </set>
        WHERE id = #{id}
    </update>

    <select id="getRecord" parameterType="Record" resultType="Record">
        <include refid="base_select" />
        <include refid="where_condition" />
        limit 1;
    </select>

    <select id="getRecordList" parameterType="Record" resultType="Record">
        <include refid="base_select" />
        <include refid="where_condition" />
    </select>

</mapper>